@using KushalBlogWebApp.Data.Model
@model SingleBlogModel
@{
    var allPinnedBlogData = ViewBag.AllPinnedBlogList as IEnumerable<BlogModel>;
}


<div class="container">
    <div class="row">
        <div class="col-md-9">

            <div class="mb-3 text-left">
                <img src="@Model.ImageUrl" alt="logo" class="auth-logo img-fluid" style="max-height: 500px;">
            </div>
            <div>
                <h5>
                    Written Date: @Model.CreatedDate.ToString("MMMM dd, yyyy"), Written By: @Model.CreatedBy
                </h5>
            </div>
            <div>
                <h2 style="color: #333;" class="text-left">@Model.BlogHeader</h2>
                <div class="text-left">
                    <p style="color: #666;">@Model.BlogBody</p>
                </div>

            </div>

            <div class="row">
                <div id="commentSection" class=" col mt-5">
                    <form>
                        <ul>
                            @if (ViewBag.Error is not null)
                            {
                                @foreach (var error in ViewBag.Error)
                                {
                                    <li class="text-danger">@error</li>
                                }
                            }
                        </ul>
                        <div class="form-group">
                            <input type="hidden" class="form-control mt-3" id="blogId" value="@ViewBag.Id">
                            <label for="fullName">Email address or Full Name</label>
                            <input type="email" class="form-control mt-3" id="fullName" aria-describedby="emailHelp" placeholder="Enter email or fullname">
                        </div>
                        <div class="form-group mt-3">
                            <label for="commentfield">Comment</label>
                            <input type="text" class="form-control mt-3" id="commentfield" placeholder="Join the discussion...">
                        </div>

                        <div class="submitBtn" style="margin: 0 auto; text-align: right; width: 100%;">
                            <button type="submit" class="btn btn-primary mt-3" onclick="submitForm()">Comment</button>
                        </div>
                    </form>

                </div>
                <div id="commentListSection">
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div style="border-bottom: 2px solid #000; width: 70%; margin-bottom: 15px;">
                <h4 style="color: #333;">Recommended Posts</h4>
            </div>

            @foreach (var post in allPinnedBlogData)
            {
                <div class="row mt-4">
                    <div class="col-4">
                        <img src="@post.ImageUrl" alt="logo" class="auth-logo img-fluid" style="max-width: 100%;">
                    </div>
                    <div class="col-8 d-flex text-left" style="max-width: 50%;">
                        <h5 class="mb-3 text-left" style="color: #333; font-weight: bold;">@post.BlogHeader</h5>
                    </div>
                </div>
            }
        </div>
    </div>


</div>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script>
    function submitForm() {
        debugger;
     
        var formData = {
            fullName: $('#fullName').val(),
            comment: $('#commentfield').val(),
            id: $('#blogId').val(),
        };

        // Perform AJAX submission
        $.ajax({
            type: 'POST', 
            url: '/Home/SaveComment',
            data: formData,
            success: function (response) {
                // Handle the success response
                console.log(response);
            },
            error: function (error) {
                // Handle the error response
                console.error(error);
            }
        });
    }
</script>
